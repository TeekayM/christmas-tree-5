<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>#chrismtas-tree-5ðŸŽ„</title>
<link rel="icon" href="favicon.ico" />
<link rel="shortcut icon" href="favicon.ico" />

<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />

<script>
  fetch("song.wav").then(r => console.log("Song loaded:", r.ok)).catch(e => console.log("Fetch error:", e));
</script>
<style>
  body {
    margin: 0;
    font-family: system-ui, sans-serif;
    background: linear-gradient(180deg, #0d144d 0%, #290d4d 90%);
    color: #08321f;
    text-align: center;
    width: 100%;
    height: 100vh;
    overflow: hidden;
  }

  .container {
    width: 100%;
    height: 100%;
    position: relative;
  }

  h1 {
    position: absolute;
    top: 12px;
    right: 24px;
    color: #ffffff;
    text-shadow: 0 2px 0 rgba(0,0,0,0.6), 0 6px 20px rgba(0,0,0,0.7);
    margin: 0;
    z-index: 5000;
    font: 28px monospace;
  }

  /* tree positioned absolute at center-bottom */
  #treeArea {
    position: fixed;
    bottom: 10vh;
    left: 50%;
    transform: translateX(-50%);
    z-index: 5000;
    display: inline-block;
    width: fit-content;
    height: auto;
    overflow: visible;
    background: transparent;
    border: none;
  }

  #treeImage {
    max-width: 144vw;
    max-height: 90vh;
    height: auto;
    width: auto;
    object-fit: contain;
    pointer-events: none;
    user-select: none;
    display: block;
  }

  .ornament {
    position: absolute;
    width: 55px;
    height: 55px;
    pointer-events: auto;
    user-select: none;
    cursor: pointer;
  }

  .ornament img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    pointer-events: none;
  }

  /* ornament info tooltip */
  #ornamentTooltip {
    position: absolute;
    z-index: 10005;
    background: rgba(0,0,0,0.9);
    color: #fff;
    padding: 8px 10px;
    border-radius: 6px;
    font: 13px/1.2 monospace;
    max-width: 220px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.45);
    transform-origin: center bottom;
    transition: opacity 160ms ease, transform 160ms ease;
    opacity: 0;
    pointer-events: none;
  }
  #ornamentTooltip.show {
    opacity: 1;
    transform: translateY(-6px) scale(1);
    pointer-events: none;
  }
  #ornamentTooltip .date { color: #a98aff; font-weight: 600; display: block; margin-bottom: 6px; }
  #ornamentTooltip:after {
    content: '';
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    bottom: -6px;
    width: 12px;
    height: 12px;
    background: rgba(0,0,0,0.9);
    transform: translateX(-50%) rotate(45deg);
    border-bottom-left-radius: 2px;
  }

  /* sky objects (moon and stars) */
  #skyObjects { position: fixed; left: 0; top: 0; width: 100%; height: 100%; z-index: 3700; pointer-events: none; }

  /* full-screen snow canvas */
  #snowCanvas {
    position: fixed;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 4000;
  }

  /* snow mounds at bottom */
  #snowMounts {
    position: fixed;
    left: 0;
    right: 0;
    bottom: 0;
    height: min(36vh, 340px);
    pointer-events: none;
    z-index: 3500;
  }

  #snowMounts svg {
    width: 100%;
    height: 100%;
    display: block;
  }

  /* removed flat white background; SVG will provide the white field */
  #snowBg { display: none; }

  /* hide activity log an d other elements for now */
  .mainRow { display: none; }
  #bgAudio { display: none; }
  #playMusicBtn { display: none; }
  #activityLog {
    margin: 12px auto 6px auto;
    max-width: 900px;
    width: min(96vw, 500px);
    background: rgba(0, 0, 0, 0.2);
    border-left: 4px solid #9774f5;
    color: #fff8f0;
    padding: 8px 12px;
    font-size: 2vh;
    text-align: left;
    left: 12px;
    top: 57px;
    border-radius: 6px;
    position: absolute;
    z-index: 10001; 
    font: 14px monospace;
    transition: transform 240ms ease, opacity 200ms ease, visibility 200ms;
    transform-origin: left top;
  }
  /* collapsed (hidden) by default */
  #activityLog.collapsed {
    opacity: 0;
    transform: translateY(-8px) scale(0.995);
    visibility: hidden;
    pointer-events: none;
  }
  /* visible state */
  #activityLog.expanded {
    opacity: 1;
    transform: translateY(0) scale(1);
    visibility: visible;
    pointer-events: auto;
  }

  /* toggle button */
  #activityToggleBtn {
    position: fixed;
    left: 12px;
    top: 12px;
    z-index: 10002;
    background: rgba(0,0,0,0.5);
    color: #fff8f0;
    border: none;
    padding: 8px 10px;
    border-radius: 6px;
    cursor: pointer;
    font: 14px monospace;
    box-shadow: 0 6px 18px rgba(0,0,0,0.4);
  }
  #activityToggleBtn:focus { outline: 2px solid #9774f5; outline-offset: 2px; }
  #activityLog h2 {
    margin: 0 0 6px 0;
    color: #a98aff;
    font-size: 24px;
  }
  .log-list { list-style: none; padding: 0; margin: 0; }
  .log-entry { padding: 4px 0; border-bottom: 1px dashed rgba(255,255,255,0.04); }
  .log-entry:last-child { border-bottom: none; }
  .log-date { color: #9774f5; font-weight: 600; margin-right: 4px; }


</style>
</head>
<body>

<div class="container">
  <h1>ðŸŽ„ #chrismtas-tree-5</h1>
    <button id="activityToggleBtn" aria-expanded="false" aria-controls="activityLog" title="Show activity log">Activity</button>

  <div id="treeArea">
    <img id="treeImage" src="tree.png" alt="Christmas Tree" />

    <div class="ornament" tabindex="0" data-date="1/12/2025" data-desc="Me petting my cat on the #chrismtas-tree-5" style="left: 22%; top: 80%; width: 13%; height: 15%;">
      <img src="./ornaments/1.png" alt="Ornament 1" />
    </div>
    <div class="ornament" tabindex="0" data-date="2/12/2025" data-desc="Dante get the golden bough dante" style="left: 34%; top: 80%; width: 14%; height: 12%; rotate: 20deg;">
      <img src="./ornaments/2.png" alt="Ornament 2" />
    </div>
    <div class="ornament" tabindex="0" data-date="3/12/2025" data-desc="The tung tung sahur, the worst thing that ever happened on the internet" style="left: 64%; top: 77%; width: 30%; height: 20%; rotate: 0deg;">
      <img src="./ornaments/3.png" alt="Ornament 3" />
    </div>
    <div class="ornament" tabindex="0" data-date="4/12/2025" data-desc="It's been a delta's rune all along. The friends we made. My pronouns are they/them" style="left: 49%; top: 77%; width: 12%; height: 15%; rotate: 0deg;">
      <img src="./ornaments/4.png" alt="Ornament 4" />
    </div>
    <div class="ornament" tabindex="0" data-date="5/12/2025" data-desc="67" style="left: 67%; top: 67%; width: 13%; height: 15%; rotate: 0deg;">
      <img src="./ornaments/5.png" alt="Ornament 5" />
    </div>
    <div class="ornament" tabindex="0" data-date="6/12/2025" data-desc="Unreal engine engine rendering in unreal engine" style="left: 64%; top: 79%; width: 10%; height: 8%; rotate: 0deg;">
      <img src="./ornaments/6.png" alt="Ornament 6" />
    </div>
    <div class="ornament" tabindex="0" data-date="7/12/2025" data-desc="Awwww look at him, little gregorius" style="left: 24%; top: 70%; width: 12%; height: 12%; rotate: 0deg;">
      <img src="./ornaments/7.gif" alt="Ornament 7" />
    </div>
  </div>

  <div id="activityLog" class="collapsed" aria-live="polite" hidden>
    <h2>Activity Log</h2>
    <ul class="log-list">
      <li class="log-entry"><span class="log-date">7/12/2025 17:00</span> -  Awwww look at him, little gregorius</li>
      <li class="log-entry"><span class="log-date">6/12/2025 00:30</span> -  Tree restructure + 67 + Unreal engine engine rendering in unreal engine</li>
      <li class="log-entry"><span class="log-date">4/12/2025 23:40</span> -  It's been a delta's rune all along. The friends we made. My pronouns are they/them</li>
      <li class="log-entry"><span class="log-date">3/12/2025 21:20</span> -  The tung tung sahur, the worst thing that ever happened on the internet</li>
      <li class="log-entry"><span class="log-date">2/12/2025 21:52</span> -  Website redesign + Dante get the golden bough dante</li>
      <li class="log-entry"><span class="log-date">1/12/2025 16:10</span> -  Me petting my cat on the #chrismtas-tree-5</li>
      <li class="log-entry"><span class="log-date">1/12/2025 01:15</span> -  The Christmas tree is here!</li>
    </ul>
  </div>

  <audio id="bgAudio" autoplay loop playsinline preload="auto">
    <source src="./song.wav" type="audio/wav">
  </audio>
  <button id="playMusicBtn" class="hidden" aria-label="Play music" title="Play music">â–¶</button>
</div>


<!-- Moon and stars in the night sky -->
<div id="skyObjects" aria-hidden="true">
  <svg id="moonSvg" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" style="position: fixed; left: 12%; top: 8%; width: 120px; height: 120px; z-index: 3800;">
    <!-- crescent moon -->
    <defs>
      <mask id="crescentMask">
        <circle cx="50" cy="50" r="48" fill="white" />
        <circle cx="82" cy="50" r="48" fill="black" />
      </mask>
    </defs>
    <circle cx="50" cy="50" r="48" fill="#f5f5dc" mask="url(#crescentMask)" />
  </svg>
</div>

<canvas id="snowCanvas" aria-hidden="true"></canvas>




<!-- Full-width snow field (SVG) with curved top so it reads as mounds, not a rectangle -->
<div id="snowMounts" aria-hidden="true">
  <svg viewBox="0 0 1200 360" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg">
    <!-- large white field with curved top (primary) -->
    <path d="M0,140 C120,100 240,170 380,140 C520,110 660,170 820,140 C980,110 1100,150 1200,140 L1200,360 L0,360 Z" fill="#ffffff" />
    <!-- subtle back contour for depth -->
    <path d="M0,170 C150,130 300,190 450,160 C600,130 750,190 900,160 C1050,130 1200,170 1200,170 L1200,360 L0,360 Z" fill="#f3f8ff" opacity="0.95" />
  </svg>
</div>

<script>
(function(){
  const canvas = document.getElementById('snowCanvas');
  if(!canvas) return;
  const ctx = canvas.getContext('2d');
  let W = 0, H = 0;
  function resize(){
    W = canvas.width = window.innerWidth;
    H = canvas.height = window.innerHeight;
  }
  window.addEventListener('resize', resize);
  resize();

  const particles = [];
  function initParticles(){
    particles.length = 0;
    const count = Math.min(250, Math.floor(W * H / 20000)) * 10;
    for(let i=0;i<count;i++) particles.push(createParticle());
  }
  function createParticle(){
    return {
      x: Math.random() * W,
      y: Math.random() * H,
      r: 1 + Math.random() * 2.5,
      vx: (Math.random() * 0.6) - 0.3,
      vy: 0.5 + Math.random() * 1.2,
      a: 0.6 + Math.random() * 0.4
    };
  }
  initParticles();

  window.addEventListener('resize', function(){
    resize();
    const newCount = Math.min(250, Math.floor(W * H / 20000));
    while(particles.length < newCount) particles.push(createParticle());
    particles.length = newCount;
  });

  function step(){
    ctx.clearRect(0,0,W,H);
    for(let p of particles){
      p.x += p.vx;
      p.y += p.vy;
      if(p.y > H + 10){ p.y = -10; p.x = Math.random() * W; }
      if(p.x > W + 10) p.x = -10;
      if(p.x < -10) p.x = W + 10;
      ctx.beginPath();
      ctx.fillStyle = 'rgba(255,255,255,' + p.a + ')';
      ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
      ctx.fill();
    }
    requestAnimationFrame(step);
  }
  requestAnimationFrame(step);
})();
</script>

<script>
(function(){
  const audio = document.getElementById('bgAudio');
  const btn = document.getElementById('playMusicBtn');
  if(!audio) return;

  function showButton(){
    if(btn) btn.classList.remove('hidden');
  }

  audio.play().then(()=>{
    if(btn) btn.classList.add('hidden');
  }).catch(err=>{

    console.log('Autoplay blocked or failed:', err);
    showButton();
  });

  function userGesture(){
    if(audio.paused){
      audio.play().catch(()=>{});
    }
    if(audio.muted) audio.muted = false;
    if(btn) btn.classList.add('hidden');
    document.removeEventListener('pointerdown', userGesture);
  }
  document.addEventListener('pointerdown', userGesture);

  if(btn){
    btn.addEventListener('click', function(e){
      e.stopPropagation();
      if(audio.paused) audio.play().catch(()=>{});
      if(audio.muted) audio.muted = false;
      btn.classList.add('hidden');
    });
  }
})();
</script>

<script>
// Activity log toggle behavior
(function(){
  const toggle = document.getElementById('activityToggleBtn');
  const log = document.getElementById('activityLog');
  if(!toggle || !log) return;

  function show(){
    log.classList.remove('collapsed');
    log.classList.add('expanded');
    log.hidden = false;
    toggle.setAttribute('aria-expanded', 'true');
    toggle.textContent = 'Hide activity';
  }
  function hide(){
    log.classList.remove('expanded');
    log.classList.add('collapsed');
    log.hidden = true;
    toggle.setAttribute('aria-expanded', 'false');
    toggle.textContent = 'Activity';
  }

  // ensure it's hidden by default
  hide();

  toggle.addEventListener('click', function(e){
    e.stopPropagation();
    const expanded = toggle.getAttribute('aria-expanded') === 'true';
    if(expanded) hide(); else show();
  });
})();
</script>

<script>
// Simple positioning - tree is fixed absolute, mounts are fixed at bottom
// No complex JS needed anymore
</script>

<!-- Ornament info tooltip script -->
<script>
(function(){
  // create tooltip element
  const tip = document.createElement('div');
  tip.id = 'ornamentTooltip';
  tip.setAttribute('role','dialog');
  tip.setAttribute('aria-hidden','true');
  tip.innerHTML = '<span class="date"></span><span class="desc"></span>';
  document.body.appendChild(tip);

  let current = null;

  function showFor(el){
    const date = el.getAttribute('data-date') || 'Unknown date';
    const desc = el.getAttribute('data-desc') || 'No description.';
    tip.querySelector('.date').textContent = date;
    tip.querySelector('.desc').textContent = desc;

    // place tooltip above element; ensure measurement after rendering
    tip.style.left = '0px';
    tip.style.top = '-9999px';
    tip.classList.add('show');
    const rect = el.getBoundingClientRect();
    const tipRect = tip.getBoundingClientRect();
    const left = rect.left + (rect.width/2) - (Math.min(tipRect.width, 220)/2);
    const top = rect.top - 10 - tipRect.height; // 10px gap

    tip.style.left = Math.max(6, left) + 'px';
    tip.style.top = Math.max(6, top) + 'px';
    tip.setAttribute('aria-hidden','false');
    current = el;
  }

  function hide(){
    tip.classList.remove('show');
    tip.setAttribute('aria-hidden','true');
    current = null;
  }

  // Show on hover (pointerenter) and on keyboard focus; hide on leave/blur
  const ornaments = document.querySelectorAll('.ornament');
  ornaments.forEach(el => {
    el.addEventListener('pointerenter', () => showFor(el));
    el.addEventListener('pointerleave', () => hide());
    el.addEventListener('focus', () => showFor(el));
    el.addEventListener('blur', () => hide());
    // keep click as no-op to avoid accidental toggles on touch
    el.addEventListener('click', (e) => { e.stopPropagation(); });
  });

  // keyboard: allow Escape to close
  document.addEventListener('keydown', function(e){
    if(e.key === 'Escape') hide();
  });

  // reposition on resize/scroll
  window.addEventListener('resize', function(){ if(current) showFor(current); });
  window.addEventListener('scroll', function(){ if(current) showFor(current); }, true);

})();
</script>

</body>
</html>
