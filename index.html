<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Christmas Memory Tree 2025</title>
<link rel="icon" href="favicon.ico" />
<link rel="shortcut icon" href="favicon.ico" />

<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />

<script>
  fetch("song.wav").then(r => console.log("Song loaded:", r.ok)).catch(e => console.log("Fetch error:", e));
</script>
<style>
  body {
    margin: 0;
    font-family: system-ui, sans-serif;
    background: linear-gradient(180deg, #06361a 0%, #02140a 60%, #030617 100%);
    color: #fff8f0;
    text-align: center;
    height: 100vh;
  }
  .container {
    margin: auto;
    padding: 12px;
  }
  #treeArea {
    position: relative;
    display: inline-block;
    width: fit-content;
    height: auto;
    border-radius: 0px;
    overflow: hidden;
    background: linear-gradient(180deg, rgba(2,20,10,0.6), rgba(0,0,0,0.25));
    border: 2px solid #b8860b;
    margin: 12px auto 0 auto;
  }
  #treeImage {
    max-width: 96vw;
    max-height: 82vh;
    height: auto;
    width: auto;
    object-fit: contain;
    pointer-events: none;
    user-select: none;
    display: block;
  }
  .ornament {
    position: absolute;
    width: 55px;
    height: 55px;
    pointer-events: none;
    user-select: none;
  }
  .ornament img {
    width: 100%;
    height: 100%;
    object-fit: contain;
  }
  #bgAudio {
    width: 100%;
    margin-top: 16px;
  }
  .note {
    opacity: 0.8;
    font-size: 12px;
    margin-top: 6px;
    color: #f3efe0;
  }

  #snowCanvas {
    position: fixed;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 9999;
  }
  h1 {
    color: #ffd700;
    text-shadow: 0 2px 0 rgba(0,0,0,0.6), 0 6px 20px rgba(0,0,0,0.4);
    margin: 8px 0;
  }

  .mainRow {
    display: block;
    margin: 0 auto;
    text-align: center;
  }
  @media (min-width: 900px) {
    .mainRow { display: inline-flex; align-items: flex-start; gap: 18px; }
    .mainRow > #treeArea { flex: none; }
    .mainRow > #activityLog { flex: none; width: 320px; }
  }

  #activityLog {
    margin: 12px auto 6px auto;
    max-width: 900px;
    width: min(96vw, 900px);
    background: rgba(255,255,255,0.03);
    border-left: 4px solid #ffd700;
    color: #fff8f0;
    padding: 8px 12px;
    font-size: 13px;
    text-align: left;
    border-radius: 6px;
    position: relative;
    z-index: 10001; 
  }
  #activityLog h2 {
    margin: 0 0 6px 0;
    color: #ffe08a;
    font-size: 14px;
  }
  .log-list { list-style: none; padding: 0; margin: 0; }
  .log-entry { padding: 4px 0; border-bottom: 1px dashed rgba(255,255,255,0.04); }
  .log-entry:last-child { border-bottom: none; }
  .log-date { color: #ffd700; font-weight: 600; margin-right: 4px; }

  #playMusicBtn {
    position: fixed;
    right: 18px;
    bottom: 18px;
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background: linear-gradient(180deg,#ffd700,#e0a800);
    color: #0b2310;
    border: none;
    font-size: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(0,0,0,0.4);
    cursor: pointer;
    z-index: 11000;
    pointer-events: auto; 
  }
  #playMusicBtn.hidden { display: none; }
</style>
</head>
<body>

<div class="container">
  <h1>ðŸŽ„ #chrismtas-tree-5</h1>

  <div class="mainRow">
    <div id="treeArea">
      <img id="treeImage" src="tree.png" alt="Christmas Tree" />

      <div class="ornament" style="left: 22%; top: 78%; width: 17%; height: 17%;">
        <img src="./ornaments/1.png" alt="Ornament 1" />
      </div>
    </div>

    <div id="activityLog" aria-live="polite">
      <h2>Activity Log</h2>
      <ul class="log-list">
        <li class="log-entry"><span class="log-date">1/12/2025 4:10 PM</span> -  Me petting my cat on the #chrismtas-tree-5</li>
        <li class="log-entry"><span class="log-date">1/12/2025 1:15 AM</span> -  The Christmas tree is here!</li>
      </ul>
    </div>
  </div>

  <audio id="bgAudio" autoplay loop playsinline preload="auto">
    <source src="./song.wav" type="audio/wav">
  </audio>
  <button id="playMusicBtn" class="hidden" aria-label="Play music" title="Play music">â–¶</button>
</div>


<canvas id="snowCanvas" aria-hidden="true"></canvas>

<script>
(function(){
  const canvas = document.getElementById('snowCanvas');
  if(!canvas) return;
  const ctx = canvas.getContext('2d');
  let W = 0, H = 0;
  function resize(){
    W = canvas.width = window.innerWidth;
    H = canvas.height = window.innerHeight;
  }
  window.addEventListener('resize', resize);
  resize();

  const particles = [];
  function initParticles(){
    particles.length = 0;
    const count = Math.min(250, Math.floor(W * H / 20000));
    for(let i=0;i<count;i++) particles.push(createParticle());
  }
  function createParticle(){
    return {
      x: Math.random() * W,
      y: Math.random() * H,
      r: 1 + Math.random() * 2.5,
      vx: (Math.random() * 0.6) - 0.3,
      vy: 0.5 + Math.random() * 1.2,
      a: 0.6 + Math.random() * 0.4
    };
  }
  initParticles();

  window.addEventListener('resize', function(){
    resize();
    const newCount = Math.min(250, Math.floor(W * H / 20000));
    while(particles.length < newCount) particles.push(createParticle());
    particles.length = newCount;
  });

  function step(){
    ctx.clearRect(0,0,W,H);
    for(let p of particles){
      p.x += p.vx;
      p.y += p.vy;
      if(p.y > H + 10){ p.y = -10; p.x = Math.random() * W; }
      if(p.x > W + 10) p.x = -10;
      if(p.x < -10) p.x = W + 10;
      ctx.beginPath();
      ctx.fillStyle = 'rgba(255,255,255,' + p.a + ')';
      ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
      ctx.fill();
    }
    requestAnimationFrame(step);
  }
  requestAnimationFrame(step);
})();
</script>

<script>
(function(){
  const audio = document.getElementById('bgAudio');
  const btn = document.getElementById('playMusicBtn');
  if(!audio) return;

  function showButton(){
    if(btn) btn.classList.remove('hidden');
  }

  audio.play().then(()=>{
    if(btn) btn.classList.add('hidden');
  }).catch(err=>{

    console.log('Autoplay blocked or failed:', err);
    showButton();
  });

  function userGesture(){
    if(audio.paused){
      audio.play().catch(()=>{});
    }
    if(audio.muted) audio.muted = false;
    if(btn) btn.classList.add('hidden');
    document.removeEventListener('pointerdown', userGesture);
  }
  document.addEventListener('pointerdown', userGesture);

  if(btn){
    btn.addEventListener('click', function(e){
      e.stopPropagation();
      if(audio.paused) audio.play().catch(()=>{});
      if(audio.muted) audio.muted = false;
      btn.classList.add('hidden');
    });
  }
})();
</script>

</body>
</html>
